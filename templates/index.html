{% extends "layout.html" %}

{% block title %}Home - Lung Nodule Detection{% endblock %}

{% block content %}
<h2>CT Scan Analysis</h2>

{% if not user %}
<div style="background: #fff3cd; padding: 20px; border-radius: 5px; margin: 20px 0;">
    <p><strong>Please log in to analyze CT scans.</strong></p>
    <a href="{{ url_for('login') }}" class="btn">Login</a>
    <a href="{{ url_for('register') }}" class="btn btn-secondary">Register</a>
</div>
{% else %}
<p>Welcome, <strong>{{ user.name }}</strong>! Upload a CT scan or provide an image URL to analyze.</p>

<form method="POST" action="{{ url_for('analyze') }}" enctype="multipart/form-data">
    <div class="form-group">
        <label for="file">Upload CT Scan (.mhd) or Image:</label>
        <input type="file" id="file" name="file" accept=".mhd,.mha,.nii,.nii.gz,.png,.jpg,.jpeg">
    </div>
    
    <div class="form-group">
        <label for="url">Or provide image URL:</label>
        <input type="text" id="url" name="url" placeholder="https://example.com/image.png">
    </div>
    
    {% if models %}
    <div class="form-group">
        <label for="model">Select Model:</label>
        <select id="model" name="model">
            {% for model in models %}
            <option value="{{ model }}" {% if 'retina' in model.lower() %}selected{% endif %}>{{ model }}</option>
            {% endfor %}
        </select>
    </div>
    {% endif %}
    
    <button type="submit" class="btn">Analyze Scan</button>
</form>
{% endif %}
{% endblock %}
